<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Hero.ai – Play Game</title>
  <style>
    body {
      background: #111;
      color: white;
      text-align: center;
      font-family: sans-serif;
      padding: 20px;
    }
    canvas {
      border: 2px solid white;
      margin-top: 20px;
    }
  </style>
</head>
<body>

<h2>Your Game</h2>
<p>Loading game...</p>

<canvas id="gameCanvas" width="600" height="400"></canvas>

<script>
// ✅ Pull the game ID from the URL  
// Example: hero-ai.vercel.app/game/abc123  → id = "abc123"
const id = window.location.pathname.replace("/game/", "");

async function loadGame() {
  // ✅ Fetch saved game data from Supabase
  const response = await fetch(
    `https://wbggwezvocfreijjfslg.supabase.co/rest/v1/games?id=eq.${id}`,
    {
      headers: {
        "apikey": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndiZ2d3ZXp2b2NmcmVpampmc2xnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwODY1NjgsImV4cCI6MjA3NjY2MjU2OH0.PrHa4y8KiCHwEektM1oCms4W9qKEeC6eRtxzPCAInlw",
        "Content-Type": "application/json",
        "Prefer": "return=representation"
      }
    }
  );

  const data = await response.json();

  // ✅ If no game found
  if (!data || !data[0]) {
    document.body.innerHTML = "<h2>❌ Game not found</h2>";
    return;
  }

  // ✅ Remove loading text
  document.querySelector("p").remove();

  // ✅ Run the saved game code
  try {
    eval(data[0].code);
  } catch (err) {
    document.body.innerHTML = "<h2>❌ Error loading game</h2>";
    console.error(err);
  }
}

loadGame();
</script>

</body>
</html>
